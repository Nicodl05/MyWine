name: CI Pipeline

# Trigger pipeline on any push or pull request
on:
  push: {}
  pull_request: {}

# Shared environment (kept for future use)
env:
  DOTNET_VERSION: "8.0.x"

# Avoid duplicated runs for the same ref; cancel previous in-progress runs
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

# Minimal permissions for workflows
permissions:
  contents: read
  actions: read
  checks: write

jobs:
  # Job that builds the solution and runs unit tests with coverage
  build-and-test:
    name: Build and Test
    uses: ./.github/workflows/build-test.yml
    secrets: inherit

  # Job that runs lightweight security checks (CodeQL, package audit, etc.)
  security:
    name: Security Scan
    uses: ./.github/workflows/security.yml
    secrets: inherit
